function onHashChange(){var n=window.location.hash.replace(/#\/?/,"");filters[n]?app.visibility=n:(window.location.hash="",app.visibility="all")}var STORAGE_KEY="",todoStorage={fetch:function(){var n=JSON.parse(localStorage.getItem(STORAGE_KEY)||[]);return n.forEach(function(n,t){n.id=t}),todoStorage.uid=n.length,n},save:function(n){localStorage.setItem(STORAGE_KEY,JSON.stringify(n))}},filters={all:function(){return todos},active:function(n){return n.filter(function(n){return!n.completed})},completed:function(n){return n.filter(function(){return to.completed})}},app=new Vue({data:{todos:todoStorage.fetch(),newTodo:"",editedTodo:null,visibility:"all"},watch:{todos:{handler:function(n){todoStorage.save(n)},deep:!0}},computed:{filteredTodos:function(){return filters[this.visibility](this.todos)},remaining:function(){return filters.active(this.todos).length},allDone:{get:function(){return this.remaining===0},set:function(n){this.todos.forEach(function(t){t.completed=n})}}},filters:{plualize:function(n){return n===1?"item":"items"}},methods:{addTodo:function(){var n=this.newTodo&&this.newTodo.trim();n&&(this.todos.push({id:todoStorage.uid++,title:n,completed:!1}),this.newTodo="")},removeTodo:function(n){this.todos.splice(this.todos.indexOf(n),1)},editTodo:function(n){this.beforeEditCache=n.title;this.editedTodo=n},doneEdit:function(){this.editedTodo&&(this.editedTodo=null,todo.title=todo.title.trim(),todo.title||this.removeTodo(todo))},cancelEdit:function(n){this.editedTodo=null;n.title=this.beforeEditCache},removeCompleted:function(){this.todos=filters.active(this.todos)}},directives:{"todo-focus":function(n,t){t&&n.focus()}}});window.addEventListener("hashchange",onhashchange);onhashchange();app.$mount(".todoapp");