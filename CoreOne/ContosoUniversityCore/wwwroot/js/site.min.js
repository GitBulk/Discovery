var highlightFields=function(n){$(".form-group").removeClass("has-error");$.each(n,function(n,t){var i='[name = "'+n.replace(/(:|\.|\[|\])/g,"\\$1")+'"]',r="#"+n.replace(/(:|\.|\[|\])/g,"\\$1"),u=$(i)||$(r);t.Errors.length>0&&u.closest(".form-group").addClass("has-error")})},highlightErrors=function(n){try{var t=JSON.parse(n.responseText);highlightFields(t);showSummary(t);window.scrollTo(0,0)}catch(i){}},showSummary=function(n){var u;$("#validationSummary").empty().removeClass("hidden");var i=_.flatten(_.map(n,"Errors")),t=[],r=_.reject(i,function(n){return n.ErrorMessage.indexOf("must not be empty")>-1});_.each(r,function(n){t.push(n.ErrorMessage)});r.length!==i.length&&t.push("The highlighted fields are required to submit this form.");u=$("#validationSummary").append("<ul><\/ul>");_.each(t,function(n){var t=$("<li><\/li>").text(n);t.appendTo(u)})},redirect=function(n){n.redirect?window.location=n.redirect:(window.scrollTo(0,0),window.location.reload())};$("form[method=post]").not(".no-ajax").on("submit",function(){var t=$(this).find('[type="submit"]'),n,i;return t.prop("disabled",!0),$(window).unbind(),n=$(this),i=n.serialize(),n.find("div").removeClass("has-error"),$.ajax({url:n.attr("action"),type:"post",data:i,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",statusCode:{200:redirect},complete:function(){t.prop("disabled",!1)}}).error(highlightErrors),!1});